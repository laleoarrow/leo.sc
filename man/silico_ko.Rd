% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sko.R
\name{silico_ko}
\alias{silico_ko}
\title{In-silico Knock-Out / Knock-In Analysis (single gene)}
\usage{
silico_ko(
  all,
  gene,
  sko_mode = c("ko", "ki"),
  cell_col = "cell_anno",
  filter_cell_threshold = 10,
  pct_threshold = 0.1,
  abs_threshold = NULL,
  deg_method = "default",
  enrichment_method = c("ORA", "GSEA"),
  enrichment_bg = c("GO", "KEGG", "MKEGG", "Reactome")
)
}
\arguments{
\item{all}{A Seurat object containing expression data and cell metadata.}

\item{gene}{Character(1). The target gene symbol (must exist in the expression matrix).}

\item{sko_mode}{One of \code{c("ko", "ki")}. Specifies virtual knock-out ("ko") or knock-in ("ki") mode.}

\item{cell_col}{Character(1). The metadata column indicating cell type.}

\item{filter_cell_threshold}{Integer. Minimum number of cells per cell type to retain.}

\item{pct_threshold}{Numeric. Fraction of expressing cells to extract per group
(ignored if \code{abs_threshold} is set).}

\item{abs_threshold}{Integer. Absolute number of cells per group to extract;
overrides \code{pct_threshold} if provided.}

\item{deg_method}{Character. Differential expression method: \code{"default"} or \code{"MAST"}.}

\item{enrichment_method}{Character vector. Enrichment methods to run; default is \code{c("ORA", "GSEA")}.}

\item{enrichment_bg}{Character vector. Background databases for enrichment;
default is \code{c("GO", "KEGG", "MKEGG", "Reactome")}.}
}
\value{
Invisibly returns a list containing:
\itemize{
\item \code{high_cells}: Vector of selected high-expression cells.
\item \code{low_cells}: Vector of selected low-expression cells.
\item \code{cell_rato}: Data frame summarizing cell-type composition.
\item \code{deg_results}: Differential expression results (data frame).
\item \code{enrichments}: Enrichment analysis results.
}
}
\description{
Performs a virtual knock-out or knock-in simulation for a target gene
in a single-cell dataset. The function identifies cells with high or
low expression of the gene, matches group sizes and cell-type composition,
and performs differential expression and enrichment analysis to infer
potential functional effects.
}
\details{
The pipeline includes:
\enumerate{
\item Filtering cells expressing the target gene.
\item Retaining cell types with sufficient cell counts.
\item Selecting top-expressing cells (high group) and matched low-expressing cells (low group).
\item Running differential expression between the two groups using \code{Seurat::FindMarkers}.
\item Performing enrichment analysis via \code{leo.basic::leo_enrich}.
}
}
\examples{
\dontrun{
res <- silico_ko(
  all = srt, gene = "LRRK2",
  sko_mode = "ko", cell_col = "cell_anno",
  pct_threshold = 0.1, deg_method = "default"
)
}

}
\seealso{
\code{\link[Seurat]{FindMarkers}}, \code{\link[leo.basic]{leo_enrich}}
}
